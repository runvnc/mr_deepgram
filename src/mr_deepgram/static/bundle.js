(function(){"use strict";var $e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function V(T){if(T.__esModule)return T;var k=T.default;if(typeof k=="function"){var U=function G(){return this instanceof G?Reflect.construct(k,arguments,this.constructor):k.apply(this,arguments)};U.prototype=k.prototype}else U={};return Object.defineProperty(U,"__esModule",{value:!0}),Object.keys(T).forEach(function(G){var X=Object.getOwnPropertyDescriptor(T,G);Object.defineProperty(U,G,X.get?X:{enumerable:!0,get:function(){return T[G]}})}),U}function Ne(T){throw new Error('Could not dynamically require "'+T+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ge={exports:{}};const Ce=new Proxy({},{get(T,k){throw new Error(`Module "crypto" has been externalized for browser compatibility. Cannot access "crypto.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),qe=V(Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"}))),Ue=new Proxy({},{get(T,k){throw new Error(`Module "events" has been externalized for browser compatibility. Cannot access "events.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Be=V(Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"}))),Re=new Proxy({},{get(T,k){throw new Error(`Module "fs" has been externalized for browser compatibility. Cannot access "fs.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),je=V(Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"}))),Me=new Proxy({},{get(T,k){throw new Error(`Module "http" has been externalized for browser compatibility. Cannot access "http.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Ie=V(Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"}))),De=new Proxy({},{get(T,k){throw new Error(`Module "https" has been externalized for browser compatibility. Cannot access "https.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Ae=V(Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}))),We=new Proxy({},{get(T,k){throw new Error(`Module "net" has been externalized for browser compatibility. Cannot access "net.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Ge=V(Object.freeze(Object.defineProperty({__proto__:null,default:We},Symbol.toStringTag,{value:"Module"}))),ze=new Proxy({},{get(T,k){throw new Error(`Module "os" has been externalized for browser compatibility. Cannot access "os.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Fe=V(Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}))),Ve=new Proxy({},{get(T,k){throw new Error(`Module "path" has been externalized for browser compatibility. Cannot access "path.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),He=V(Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"}))),Ke=new Proxy({},{get(T,k){throw new Error(`Module "querystring" has been externalized for browser compatibility. Cannot access "querystring.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Ye=V(Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"}))),Je=new Proxy({},{get(T,k){throw new Error(`Module "stream" has been externalized for browser compatibility. Cannot access "stream.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Xe=V(Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"}))),Ze=new Proxy({},{get(T,k){throw new Error(`Module "tls" has been externalized for browser compatibility. Cannot access "tls.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Qe=V(Object.freeze(Object.defineProperty({__proto__:null,default:Ze},Symbol.toStringTag,{value:"Module"}))),et=new Proxy({},{get(T,k){throw new Error(`Module "url" has been externalized for browser compatibility. Cannot access "url.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),tt=V(Object.freeze(Object.defineProperty({__proto__:null,default:et},Symbol.toStringTag,{value:"Module"}))),rt=new Proxy({},{get(T,k){throw new Error(`Module "zlib" has been externalized for browser compatibility. Cannot access "zlib.${k}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),it=V(Object.freeze(Object.defineProperty({__proto__:null,default:rt},Symbol.toStringTag,{value:"Module"})));(function(T,k){var U={};(function(G,X){T.exports=X()})($e,()=>(()=>{var G={343:(y,p,n)=>{n.r(p),n.d(p,{Billing:()=>g});var c=function(m,f,i,h){return new(i||(i=Promise))(function(o,_){function d(r){try{s(h.next(r))}catch(e){_(e)}}function t(r){try{s(h.throw(r))}catch(e){_(e)}}function s(r){var e;r.done?o(r.value):(e=r.value,e instanceof i?e:new i(function(u){u(e)})).then(d,t)}s((h=h.apply(m,[])).next())})};class g{constructor(f,i,h,o){this._credentials=f,this._apiUrl=i,this._requireSSL=h,this._request=o,this.apiPath="/v1/projects"}listBalances(f){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/balances`)})}getBalance(f,i){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/balances/${i}`)})}}},986:(y,p,n)=>{n.r(p),n.d(p,{DefaultOptions:()=>c});const c={apiUrl:"api.deepgram.com",requireSSL:!0}},344:(y,p,n)=>{var c;n.r(p),n.d(p,{ConnectionState:()=>c}),function(g){g[g.CONNECTING=0]="CONNECTING",g[g.OPEN=1]="OPEN",g[g.CLOSING=2]="CLOSING",g[g.CLOSED=3]="CLOSED"}(c||(c={}))},298:(y,p,n)=>{n.r(p),n.d(p,{secondsToTimestamp:()=>c.k,validateOptions:()=>g});var c=n(489);function g(m,f){if(!m||m.trim().length===0)throw new Error("DG: API key is required");if(!f||f.trim().length===0)throw new Error("DG: API url should be a valid url or not provided")}},489:(y,p,n)=>{function c(g){return new Date(1e3*g).toISOString().substr(11,12)}n.d(p,{k:()=>c})},98:function(y,p,n){var c=this&&this.__assign||function(){return c=Object.assign||function(o){for(var _,d=1,t=arguments.length;d<t;d++)for(var s in _=arguments[d])Object.prototype.hasOwnProperty.call(_,s)&&(o[s]=_[s]);return o},c.apply(this,arguments)},g=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(p,"__esModule",{value:!0}),p._request=void 0;var m=n(781),f=g(n(687)),i=g(n(685)),h=n(408);p._request=function(o,_,d,t,s,r,e){var u=function(a,l,v,w,b,O,q){var R={};!O||O instanceof m.Readable||(R["Content-Length"]=Buffer.byteLength(O));var B={host:l,protocol:v?"https:":"http:",path:w,method:b,headers:c({"User-Agent":(0,h.userAgent)(),"Content-Type":"application/json",Authorization:"token ".concat(a)},R)},P=B.headers;return q&&q.headers&&(P=c(c({},P),q.headers)),c(c(c({},B),q),{headers:P})}(_,d,t,s,o,r,e);return new Promise(function(a,l){try{var v=(t?f.default:i.default).request(u,function(w){var b="";w.on("data",function(O){b+=O}),w.on("end",function(){var O;try{O=JSON.parse(b)}catch{O={error:b}}w.statusCode&&w.statusCode>=400&&(O.error,l("DG: ".concat(JSON.stringify(O)))),O.error&&l("DG: ".concat(b)),a(O)}),w.on("error",function(O){l("DG: ".concat(O))})});v.on("error",function(w){l("DG: ".concat(w))}),r?r instanceof m.Readable?(r.pipe(v),r.on("finish",function(){v.end()})):(v.write(r),v.end()):v.end()}catch(w){l("DG: ".concat(w))}})}},359:(y,p,n)=>{n.r(p),n.d(p,{Invitation:()=>g});var c=function(m,f,i,h){return new(i||(i=Promise))(function(o,_){function d(r){try{s(h.next(r))}catch(e){_(e)}}function t(r){try{s(h.throw(r))}catch(e){_(e)}}function s(r){var e;r.done?o(r.value):(e=r.value,e instanceof i?e:new i(function(u){u(e)})).then(d,t)}s((h=h.apply(m,[])).next())})};class g{constructor(f,i,h,o){this._credentials=f,this._apiUrl=i,this._requireSSL=h,this._request=o,this.apiPath="/v1/projects"}list(f){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/invites`)})}send(f,i){return c(this,void 0,void 0,function*(){return this._request("POST",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/invites`,JSON.stringify({email:i.email,scope:i.scope}))})}leave(f){return c(this,void 0,void 0,function*(){return this._request("DELETE",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/leave`)})}delete(f,i){return c(this,void 0,void 0,function*(){return this._request("DELETE",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/invites/${i}`)})}}},292:(y,p,n)=>{n.r(p),n.d(p,{Keys:()=>g});var c=function(m,f,i,h){return new(i||(i=Promise))(function(o,_){function d(r){try{s(h.next(r))}catch(e){_(e)}}function t(r){try{s(h.throw(r))}catch(e){_(e)}}function s(r){var e;r.done?o(r.value):(e=r.value,e instanceof i?e:new i(function(u){u(e)})).then(d,t)}s((h=h.apply(m,[])).next())})};class g{constructor(f,i,h,o){this._credentials=f,this._apiUrl=i,this._requireSSL=h,this._request=o,this.apiPath="/v1/projects"}list(f){return c(this,void 0,void 0,function*(){return{api_keys:(yield this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/keys`)).api_keys.map(i=>Object.assign(Object.assign({},i),i.api_key))}})}get(f,i){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/keys/${i}`)})}create(f,i,h,o){return c(this,void 0,void 0,function*(){if(o&&o.expirationDate!==void 0&&o.timeToLive!==void 0)throw new Error("Please provide expirationDate or timeToLive or neither. Providing both is not allowed.");return this._request("POST",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/keys`,JSON.stringify({comment:i,scopes:h,expiration_date:o&&o.expirationDate?o.expirationDate:void 0,time_to_live_in_seconds:o&&o.timeToLive?o.timeToLive:void 0}))})}delete(f,i){return c(this,void 0,void 0,function*(){return this._request("DELETE",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/keys/${i}`)})}}},949:(y,p,n)=>{n.r(p),n.d(p,{Members:()=>g});var c=function(m,f,i,h){return new(i||(i=Promise))(function(o,_){function d(r){try{s(h.next(r))}catch(e){_(e)}}function t(r){try{s(h.throw(r))}catch(e){_(e)}}function s(r){var e;r.done?o(r.value):(e=r.value,e instanceof i?e:new i(function(u){u(e)})).then(d,t)}s((h=h.apply(m,[])).next())})};class g{constructor(f,i,h,o){this._credentials=f,this._apiUrl=i,this._requireSSL=h,this._request=o,this.apiPath="/v1/projects"}listMembers(f){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/members`)})}removeMember(f,i){return c(this,void 0,void 0,function*(){return this._request("DELETE",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/members/${i}`)})}}},319:(y,p,n)=>{n.r(p),n.d(p,{Projects:()=>g});var c=function(m,f,i,h){return new(i||(i=Promise))(function(o,_){function d(r){try{s(h.next(r))}catch(e){_(e)}}function t(r){try{s(h.throw(r))}catch(e){_(e)}}function s(r){var e;r.done?o(r.value):(e=r.value,e instanceof i?e:new i(function(u){u(e)})).then(d,t)}s((h=h.apply(m,[])).next())})};class g{constructor(f,i,h,o){this._credentials=f,this._apiUrl=i,this._requireSSL=h,this._request=o,this.apiPath="/v1/projects"}list(){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,this.apiPath)})}get(f){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}`)})}update(f,i){return c(this,void 0,void 0,function*(){return this._request("PATCH",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f.project_id}`,JSON.stringify(i))})}delete(f){return c(this,void 0,void 0,function*(){return this._request("DELETE",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}`)})}}},647:(y,p,n)=>{n.r(p),n.d(p,{Scopes:()=>g});var c=function(m,f,i,h){return new(i||(i=Promise))(function(o,_){function d(r){try{s(h.next(r))}catch(e){_(e)}}function t(r){try{s(h.throw(r))}catch(e){_(e)}}function s(r){var e;r.done?o(r.value):(e=r.value,e instanceof i?e:new i(function(u){u(e)})).then(d,t)}s((h=h.apply(m,[])).next())})};class g{constructor(f,i,h,o){this._credentials=f,this._apiUrl=i,this._requireSSL=h,this._request=o,this.apiPath="/v1/projects"}get(f,i){return c(this,void 0,void 0,function*(){return this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/members/${i}/scopes`)})}update(f,i,h){return c(this,void 0,void 0,function*(){return this._request("PUT",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${f}/members/${i}/scopes`,JSON.stringify({scope:h}))})}}},487:function(y,p,n){var c=this&&this.__awaiter||function(h,o,_,d){return new(_||(_=Promise))(function(t,s){function r(a){try{u(d.next(a))}catch(l){s(l)}}function e(a){try{u(d.throw(a))}catch(l){s(l)}}function u(a){var l;a.done?t(a.value):(l=a.value,l instanceof _?l:new _(function(v){v(l)})).then(r,e)}u((d=d.apply(h,o||[])).next())})},g=this&&this.__generator||function(h,o){var _,d,t,s,r={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return s={next:e(0),throw:e(1),return:e(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function e(u){return function(a){return function(l){if(_)throw new TypeError("Generator is already executing.");for(;r;)try{if(_=1,d&&(t=2&l[0]?d.return:l[0]?d.throw||((t=d.return)&&t.call(d),0):d.next)&&!(t=t.call(d,l[1])).done)return t;switch(d=0,t&&(l=[2&l[0],t.value]),l[0]){case 0:case 1:t=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,d=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!((t=(t=r.trys).length>0&&t[t.length-1])||l[0]!==6&&l[0]!==2)){r=0;continue}if(l[0]===3&&(!t||l[1]>t[0]&&l[1]<t[3])){r.label=l[1];break}if(l[0]===6&&r.label<t[1]){r.label=t[1],t=l;break}if(t&&r.label<t[2]){r.label=t[2],r.ops.push(l);break}t[2]&&r.ops.pop(),r.trys.pop();continue}l=o.call(h,r)}catch(v){l=[6,v],d=0}finally{_=t=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,a])}}};Object.defineProperty(p,"__esModule",{value:!0}),p.Transcriber=void 0;var m=n(379),f=n(825),i=function(){function h(o,_,d){this._credentials=o,this._apiUrl=_,this._requireSSL=d}return h.prototype.preRecorded=function(o,_){return c(this,void 0,void 0,function(){return g(this,function(d){switch(d.label){case 0:return[4,(0,f.preRecordedTranscription)(this._credentials,this._apiUrl||"",this._requireSSL,o,_)];case 1:return[2,d.sent()]}})})},h.prototype.live=function(o){return new m.LiveTranscription(this._credentials,this._apiUrl||"",this._requireSSL,o)},h}();p.Transcriber=i},379:function(y,p,n){var c,g=this&&this.__extends||(c=function(t,s){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&(r[u]=e[u])},c(t,s)},function(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function r(){this.constructor=t}c(t,s),t.prototype=s===null?Object.create(s):(r.prototype=s.prototype,new r)}),m=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(p,"__esModule",{value:!0}),p.LiveTranscription=void 0;var f=m(n(361)),i=m(n(477)),h=m(n(777)),o=n(344),_=n(408),d=function(t){function s(r,e,u,a){var l=t.call(this,void 0)||this,v=u?"wss":"ws";return l._socket=new h.default("".concat(v,"://").concat(e,"/v1/listen?").concat(i.default.stringify(a)),{headers:{Authorization:"token ".concat(r),"User-Agent":(0,_.userAgent)()}}),l._bindSocketEvents(),l}return g(s,t),s.prototype._bindSocketEvents=function(){var r=this;this._socket.onopen=function(){r.emit("open",r)},this._socket.onclose=function(e){var u=e.target;if(u._req){var a=u._req.res.rawHeaders.indexOf("dg-error");e.reason=u._req.res.rawHeaders[a+1]}r.emit("close",e)},this._socket.onerror=function(e){r.emit("error",e)},this._socket.onmessage=function(e){r.emit("transcriptReceived",e.data)}},s.prototype.configure=function(r){this._socket.send(JSON.stringify({type:"Configure",processors:r}))},s.prototype.getReadyState=function(){return this._socket.readyState},s.prototype.send=function(r){this._socket.readyState===o.ConnectionState.OPEN?this._socket.send(r):this.emit("error","Could not send. Connection not open.")},s.prototype.finish=function(){this._socket.send(new Uint8Array(0))},s}(f.default);p.LiveTranscription=d},825:function(y,p,n){var c=this&&this.__assign||function(){return c=Object.assign||function(d){for(var t,s=1,r=arguments.length;s<r;s++)for(var e in t=arguments[s])Object.prototype.hasOwnProperty.call(t,e)&&(d[e]=t[e]);return d},c.apply(this,arguments)},g=this&&this.__awaiter||function(d,t,s,r){return new(s||(s=Promise))(function(e,u){function a(w){try{v(r.next(w))}catch(b){u(b)}}function l(w){try{v(r.throw(w))}catch(b){u(b)}}function v(w){var b;w.done?e(w.value):(b=w.value,b instanceof s?b:new s(function(O){O(b)})).then(a,l)}v((r=r.apply(d,t||[])).next())})},m=this&&this.__generator||function(d,t){var s,r,e,u,a={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(v){return function(w){return function(b){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,r&&(e=2&b[0]?r.return:b[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,b[1])).done)return e;switch(r=0,e&&(b=[2&b[0],e.value]),b[0]){case 0:case 1:e=b;break;case 4:return a.label++,{value:b[1],done:!1};case 5:a.label++,r=b[1],b=[0];continue;case 7:b=a.ops.pop(),a.trys.pop();continue;default:if(!((e=(e=a.trys).length>0&&e[e.length-1])||b[0]!==6&&b[0]!==2)){a=0;continue}if(b[0]===3&&(!e||b[1]>e[0]&&b[1]<e[3])){a.label=b[1];break}if(b[0]===6&&a.label<e[1]){a.label=e[1],e=b;break}if(e&&a.label<e[2]){a.label=e[2],a.ops.push(b);break}e[2]&&a.ops.pop(),a.trys.pop();continue}b=t.call(d,a)}catch(O){b=[6,O],r=0}finally{s=e=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([v,w])}}},f=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(p,"__esModule",{value:!0}),p.preRecordedTranscription=void 0;var i=f(n(477)),h=n(970),o=n(98);function _(d){return!!d.url}p.preRecordedTranscription=function(d,t,s,r,e){return g(void 0,void 0,void 0,function(){var u,a,l,v;return m(this,function(w){switch(w.label){case 0:if(u=c({},e),!_(r)&&(r.mimetype===void 0||r.mimetype.length===0))throw new Error("DG: Mimetype must be provided if the source is a Buffer or a Readable");if(_(r))a=JSON.stringify(r);else if(r.buffer)a=r.buffer;else{if(!r.stream)throw new Error("Unknown TranscriptionSource type");a=r.stream}return l={},_(r)||(l.headers={"Content-Type":r.mimetype}),[4,(0,o._request)("POST",d,t,s,"/v1/listen?".concat(i.default.stringify(u)),a,l)];case 1:return v=w.sent(),[2,Object.assign(new h.PrerecordedTranscriptionResponse,v)]}})})}},970:(y,p,n)=>{n.r(p),n.d(p,{PrerecordedTranscriptionResponse:()=>g});var c=n(489);class g{toWebVTT(){var f,i,h,o;if(!this.results||!this.results.utterances)throw new Error("This function requires a transcript that was generated with the utterances feature.");let _=`WEBVTT

`;_+=`NOTE
Transcription provided by Deepgram
Request Id: ${(f=this.metadata)===null||f===void 0?void 0:f.request_id}
Created: ${(i=this.metadata)===null||i===void 0?void 0:i.created}
Duration: ${(h=this.metadata)===null||h===void 0?void 0:h.duration}
Channels: ${(o=this.metadata)===null||o===void 0?void 0:o.channels}

`;for(let d=0;d<this.results.utterances.length;d++){const t=this.results.utterances[d];_+=`${d+1}
${(0,c.k)(t.start)} --> ${(0,c.k)(t.end)}
- ${t.transcript}

`}return _}toSRT(){if(!this.results||!this.results.utterances)throw new Error("This function requires a transcript that was generated with the utterances feature.");let f="";for(let i=0;i<this.results.utterances.length;i++){const h=this.results.utterances[i];f+=`${i+1}
${(0,c.k)(h.start).replace(".",",")} --> ${(0,c.k)(h.end).replace(".",",")}
${h.transcript}

`}return f}}},321:(y,p,n)=>{n.r(p),n.d(p,{Usage:()=>f});var c=n(477),g=n.n(c),m=function(i,h,o,_){return new(o||(o=Promise))(function(d,t){function s(u){try{e(_.next(u))}catch(a){t(a)}}function r(u){try{e(_.throw(u))}catch(a){t(a)}}function e(u){var a;u.done?d(u.value):(a=u.value,a instanceof o?a:new o(function(l){l(a)})).then(s,r)}e((_=_.apply(i,[])).next())})};class f{constructor(h,o,_,d){this._credentials=h,this._apiUrl=o,this._requireSSL=_,this._request=d,this.apiPath="/v1/projects"}listRequests(h,o){return m(this,void 0,void 0,function*(){const _=Object.assign({},o);return yield this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${h}/requests?${g().stringify(_)}`)})}getRequest(h,o){return m(this,void 0,void 0,function*(){return yield this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${h}/requests/${o}`)})}getUsage(h,o){return m(this,void 0,void 0,function*(){const _=Object.assign({},o);return yield this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${h}/usage?${g().stringify(_)}`)})}getFields(h,o){return m(this,void 0,void 0,function*(){const _=Object.assign({},o);return yield this._request("GET",this._credentials,this._apiUrl,this._requireSSL,`${this.apiPath}/${h}/usage/fields?${g().stringify(_)}`)})}}},408:(y,p,n)=>{function c(){let g="@deepgram/sdk/UNKNOWN node/UNKNOWN";try{g=`@deepgram/sdk/1.21.0 node/${process.version.replace("v","")}`}catch{console.warn("Could not load package details")}return g}n.r(p),n.d(p,{userAgent:()=>c})},376:y=>{y.exports={mask:(p,n,c,g,m)=>{for(var f=0;f<m;f++)c[g+f]=p[f]^n[3&f]},unmask:(p,n)=>{const c=p.length;for(var g=0;g<c;g++)p[g]^=n[3&g]}}},891:(y,p,n)=>{try{y.exports=n(516)(__dirname)}catch{y.exports=n(376)}},516:(y,p,n)=>{var c=n(147),g=n(17),m=n(37),f=Ne,i=process.config&&process.config.variables||{},h=!!U.PREBUILDS_ONLY,o=process.versions.modules,_=process.versions&&process.versions.electron||U.ELECTRON_RUN_AS_NODE||typeof window<"u"&&window.process&&window.process.type==="renderer"?"electron":"node",d=m.arch(),t=m.platform(),s=U.LIBC||(function(P){return P==="linux"&&c.existsSync("/etc/alpine-release")}(t)?"musl":"glibc"),r=U.ARM_VERSION||(d==="arm64"?"8":i.arm_version)||"",e=(process.versions.uv||"").split(".")[0];function u(P){return f(u.path(P))}function a(P){try{return c.readdirSync(P)}catch{return[]}}function l(P,C){var x=a(P).filter(C);return x[0]&&g.join(P,x[0])}function v(P){return/\.node$/.test(P)}function w(P){var C=P.split("-");if(C.length===2){var x=C[0],D=C[1].split("+");if(x&&D.length&&D.every(Boolean))return{name:P,platform:x,architectures:D}}}function b(P,C){return function(x){return x!=null&&x.platform===P&&x.architectures.includes(C)}}function O(P,C){return P.architectures.length-C.architectures.length}function q(P){var C=P.split("."),x={file:P,specificity:0};if(C.pop()==="node"){for(var D=0;D<C.length;D++){var M=C[D];if(M==="node"||M==="electron"||M==="node-webkit")x.runtime=M;else if(M==="napi")x.napi=!0;else if(M.slice(0,3)==="abi")x.abi=M.slice(3);else if(M.slice(0,2)==="uv")x.uv=M.slice(2);else if(M.slice(0,4)==="armv")x.armv=M.slice(4);else{if(M!=="glibc"&&M!=="musl")continue;x.libc=M}x.specificity++}return x}}function R(P,C){return function(x){return!(x==null||x.runtime!==P&&!function(D){return D.runtime==="node"&&D.napi}(x)||x.abi!==C&&!x.napi||x.uv&&x.uv!==e||x.armv&&x.armv!==r||x.libc&&x.libc!==s)}}function B(P){return function(C,x){return C.runtime!==x.runtime?C.runtime===P?-1:1:C.abi!==x.abi?C.abi?-1:1:C.specificity!==x.specificity?C.specificity>x.specificity?-1:1:0}}y.exports=u,u.path=function(P){P=g.resolve(P||".");try{var C=f(g.join(P,"package.json")).name.toUpperCase().replace(/-/g,"_");U[C+"_PREBUILD"]&&(P=U[C+"_PREBUILD"])}catch{}if(!h){var x=l(g.join(P,"build/Release"),v);if(x)return x;var D=l(g.join(P,"build/Debug"),v);if(D)return D}var M=Z(P);if(M)return M;var le=Z(g.dirname(process.execPath));if(le)return le;var z=["platform="+t,"arch="+d,"runtime="+_,"abi="+o,"uv="+e,r?"armv="+r:"","libc="+s,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ");throw new Error("No native build was found for "+z+`
    loaded from: `+P+`
`);function Z(te){var ue=a(g.join(te,"prebuilds")).map(w).filter(b(t,d)).sort(O)[0];if(ue){var he=g.join(te,"prebuilds",ue.name),re=a(he).map(q).filter(R(_,o)).sort(B(_))[0];return re?g.join(he,re.file):void 0}}},u.parseTags=q,u.matchTags=R,u.compareTags=B,u.parseTuple=w,u.matchTuple=b,u.compareTuples=O},137:y=>{y.exports=function(p){const n=p.length;let c=0;for(;c<n;)if(!(128&p[c]))c++;else if((224&p[c])==192){if(c+1===n||(192&p[c+1])!=128||(254&p[c])==192)return!1;c+=2}else if((240&p[c])==224){if(c+2>=n||(192&p[c+1])!=128||(192&p[c+2])!=128||p[c]===224&&(224&p[c+1])==128||p[c]===237&&(224&p[c+1])==160)return!1;c+=3}else{if((248&p[c])!=240||c+3>=n||(192&p[c+1])!=128||(192&p[c+2])!=128||(192&p[c+3])!=128||p[c]===240&&(240&p[c+1])==128||p[c]===244&&p[c+1]>143||p[c]>244)return!1;c+=4}return!0}},311:(y,p,n)=>{try{y.exports=n(516)(__dirname)}catch{y.exports=n(137)}},777:(y,p,n)=>{const c=n(762);c.createWebSocketStream=n(30),c.Server=n(284),c.Receiver=n(957),c.Sender=n(330),y.exports=c},977:(y,p,n)=>{const{EMPTY_BUFFER:c}=n(872);function g(o,_){if(o.length===0)return c;if(o.length===1)return o[0];const d=Buffer.allocUnsafe(_);let t=0;for(let s=0;s<o.length;s++){const r=o[s];d.set(r,t),t+=r.length}return t<_?d.slice(0,t):d}function m(o,_,d,t,s){for(let r=0;r<s;r++)d[t+r]=o[r]^_[3&r]}function f(o,_){const d=o.length;for(let t=0;t<d;t++)o[t]^=_[3&t]}function i(o){return o.byteLength===o.buffer.byteLength?o.buffer:o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)}function h(o){if(h.readOnly=!0,Buffer.isBuffer(o))return o;let _;return o instanceof ArrayBuffer?_=Buffer.from(o):ArrayBuffer.isView(o)?_=Buffer.from(o.buffer,o.byteOffset,o.byteLength):(_=Buffer.from(o),h.readOnly=!1),_}try{const o=n(891),_=o.BufferUtil||o;y.exports={concat:g,mask(d,t,s,r,e){e<48?m(d,t,s,r,e):_.mask(d,t,s,r,e)},toArrayBuffer:i,toBuffer:h,unmask(d,t){d.length<32?f(d,t):_.unmask(d,t)}}}catch{y.exports={concat:g,mask:m,toArrayBuffer:i,toBuffer:h,unmask:f}}},872:y=>{y.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},62:y=>{class p{constructor(h,o){this.target=o,this.type=h}}class n extends p{constructor(h,o){super("message",o),this.data=h}}class c extends p{constructor(h,o,_){super("close",_),this.wasClean=_._closeFrameReceived&&_._closeFrameSent,this.reason=o,this.code=h}}class g extends p{constructor(h){super("open",h)}}class m extends p{constructor(h,o){super("error",o),this.message=h.message,this.error=h}}const f={addEventListener(i,h,o){if(typeof h!="function")return;function _(e){h.call(this,new n(e,this))}function d(e,u){h.call(this,new c(e,u,this))}function t(e){h.call(this,new m(e,this))}function s(){h.call(this,new g(this))}const r=o&&o.once?"once":"on";i==="message"?(_._listener=h,this[r](i,_)):i==="close"?(d._listener=h,this[r](i,d)):i==="error"?(t._listener=h,this[r](i,t)):i==="open"?(s._listener=h,this[r](i,s)):this[r](i,h)},removeEventListener(i,h){const o=this.listeners(i);for(let _=0;_<o.length;_++)o[_]!==h&&o[_]._listener!==h||this.removeListener(i,o[_])}};y.exports=f},503:y=>{const p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function n(c,g,m){c[g]===void 0?c[g]=[m]:c[g].push(m)}y.exports={format:function(c){return Object.keys(c).map(g=>{let m=c[g];return Array.isArray(m)||(m=[m]),m.map(f=>[g].concat(Object.keys(f).map(i=>{let h=f[i];return Array.isArray(h)||(h=[h]),h.map(o=>o===!0?i:`${i}=${o}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(c){const g=Object.create(null);if(c===void 0||c==="")return g;let m,f,i=Object.create(null),h=!1,o=!1,_=!1,d=-1,t=-1,s=0;for(;s<c.length;s++){const e=c.charCodeAt(s);if(m===void 0)if(t===-1&&p[e]===1)d===-1&&(d=s);else if(e===32||e===9)t===-1&&d!==-1&&(t=s);else{if(e!==59&&e!==44)throw new SyntaxError(`Unexpected character at index ${s}`);{if(d===-1)throw new SyntaxError(`Unexpected character at index ${s}`);t===-1&&(t=s);const u=c.slice(d,t);e===44?(n(g,u,i),i=Object.create(null)):m=u,d=t=-1}}else if(f===void 0)if(t===-1&&p[e]===1)d===-1&&(d=s);else if(e===32||e===9)t===-1&&d!==-1&&(t=s);else if(e===59||e===44){if(d===-1)throw new SyntaxError(`Unexpected character at index ${s}`);t===-1&&(t=s),n(i,c.slice(d,t),!0),e===44&&(n(g,m,i),i=Object.create(null),m=void 0),d=t=-1}else{if(e!==61||d===-1||t!==-1)throw new SyntaxError(`Unexpected character at index ${s}`);f=c.slice(d,s),d=t=-1}else if(o){if(p[e]!==1)throw new SyntaxError(`Unexpected character at index ${s}`);d===-1?d=s:h||(h=!0),o=!1}else if(_)if(p[e]===1)d===-1&&(d=s);else if(e===34&&d!==-1)_=!1,t=s;else{if(e!==92)throw new SyntaxError(`Unexpected character at index ${s}`);o=!0}else if(e===34&&c.charCodeAt(s-1)===61)_=!0;else if(t===-1&&p[e]===1)d===-1&&(d=s);else if(d===-1||e!==32&&e!==9){if(e!==59&&e!==44)throw new SyntaxError(`Unexpected character at index ${s}`);{if(d===-1)throw new SyntaxError(`Unexpected character at index ${s}`);t===-1&&(t=s);let u=c.slice(d,t);h&&(u=u.replace(/\\/g,""),h=!1),n(i,f,u),e===44&&(n(g,m,i),i=Object.create(null),m=void 0),f=void 0,d=t=-1}}else t===-1&&(t=s)}if(d===-1||_)throw new SyntaxError("Unexpected end of input");t===-1&&(t=s);const r=c.slice(d,t);return m===void 0?n(g,r,i):(f===void 0?n(i,r,!0):n(i,f,h?r.replace(/\\/g,""):r),n(g,m,i)),g}}},305:y=>{const p=Symbol("kDone"),n=Symbol("kRun");y.exports=class{constructor(c){this[p]=()=>{this.pending--,this[n]()},this.concurrency=c||1/0,this.jobs=[],this.pending=0}add(c){this.jobs.push(c),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){const c=this.jobs.shift();this.pending++,c(this[p])}}}},196:(y,p,n)=>{const c=n(796),g=n(977),m=n(305),{kStatusCode:f,NOOP:i}=n(872),h=Buffer.from([0,0,255,255]),o=Symbol("permessage-deflate"),_=Symbol("total-length"),d=Symbol("callback"),t=Symbol("buffers"),s=Symbol("error");let r;function e(l){this[t].push(l),this[_]+=l.length}function u(l){this[_]+=l.length,this[o]._maxPayload<1||this[_]<=this[o]._maxPayload?this[t].push(l):(this[s]=new RangeError("Max payload size exceeded"),this[s].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[s][f]=1009,this.removeListener("data",u),this.reset())}function a(l){this[o]._inflate=null,l[f]=1007,this[d](l)}y.exports=class{constructor(l,v,w){if(this._maxPayload=0|w,this._options=l||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!v,this._deflate=null,this._inflate=null,this.params=null,!r){const b=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;r=new m(b)}}static get extensionName(){return"permessage-deflate"}offer(){const l={};return this._options.serverNoContextTakeover&&(l.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(l.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(l.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?l.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(l.client_max_window_bits=!0),l}accept(l){return l=this.normalizeParams(l),this.params=this._isServer?this.acceptAsServer(l):this.acceptAsClient(l),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const l=this._deflate[d];this._deflate.close(),this._deflate=null,l&&l(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(l){const v=this._options,w=l.find(b=>!(v.serverNoContextTakeover===!1&&b.server_no_context_takeover||b.server_max_window_bits&&(v.serverMaxWindowBits===!1||typeof v.serverMaxWindowBits=="number"&&v.serverMaxWindowBits>b.server_max_window_bits)||typeof v.clientMaxWindowBits=="number"&&!b.client_max_window_bits));if(!w)throw new Error("None of the extension offers can be accepted");return v.serverNoContextTakeover&&(w.server_no_context_takeover=!0),v.clientNoContextTakeover&&(w.client_no_context_takeover=!0),typeof v.serverMaxWindowBits=="number"&&(w.server_max_window_bits=v.serverMaxWindowBits),typeof v.clientMaxWindowBits=="number"?w.client_max_window_bits=v.clientMaxWindowBits:w.client_max_window_bits!==!0&&v.clientMaxWindowBits!==!1||delete w.client_max_window_bits,w}acceptAsClient(l){const v=l[0];if(this._options.clientNoContextTakeover===!1&&v.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(v.client_max_window_bits){if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&v.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else typeof this._options.clientMaxWindowBits=="number"&&(v.client_max_window_bits=this._options.clientMaxWindowBits);return v}normalizeParams(l){return l.forEach(v=>{Object.keys(v).forEach(w=>{let b=v[w];if(b.length>1)throw new Error(`Parameter "${w}" must have only a single value`);if(b=b[0],w==="client_max_window_bits"){if(b!==!0){const O=+b;if(!Number.isInteger(O)||O<8||O>15)throw new TypeError(`Invalid value for parameter "${w}": ${b}`);b=O}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${w}": ${b}`)}else if(w==="server_max_window_bits"){const O=+b;if(!Number.isInteger(O)||O<8||O>15)throw new TypeError(`Invalid value for parameter "${w}": ${b}`);b=O}else{if(w!=="client_no_context_takeover"&&w!=="server_no_context_takeover")throw new Error(`Unknown parameter "${w}"`);if(b!==!0)throw new TypeError(`Invalid value for parameter "${w}": ${b}`)}v[w]=b})}),l}decompress(l,v,w){r.add(b=>{this._decompress(l,v,(O,q)=>{b(),w(O,q)})})}compress(l,v,w){r.add(b=>{this._compress(l,v,(O,q)=>{b(),w(O,q)})})}_decompress(l,v,w){const b=this._isServer?"client":"server";if(!this._inflate){const O=`${b}_max_window_bits`,q=typeof this.params[O]!="number"?c.Z_DEFAULT_WINDOWBITS:this.params[O];this._inflate=c.createInflateRaw({...this._options.zlibInflateOptions,windowBits:q}),this._inflate[o]=this,this._inflate[_]=0,this._inflate[t]=[],this._inflate.on("error",a),this._inflate.on("data",u)}this._inflate[d]=w,this._inflate.write(l),v&&this._inflate.write(h),this._inflate.flush(()=>{const O=this._inflate[s];if(O)return this._inflate.close(),this._inflate=null,void w(O);const q=g.concat(this._inflate[t],this._inflate[_]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[_]=0,this._inflate[t]=[],v&&this.params[`${b}_no_context_takeover`]&&this._inflate.reset()),w(null,q)})}_compress(l,v,w){const b=this._isServer?"server":"client";if(!this._deflate){const O=`${b}_max_window_bits`,q=typeof this.params[O]!="number"?c.Z_DEFAULT_WINDOWBITS:this.params[O];this._deflate=c.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:q}),this._deflate[_]=0,this._deflate[t]=[],this._deflate.on("error",i),this._deflate.on("data",e)}this._deflate[d]=w,this._deflate.write(l),this._deflate.flush(c.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let O=g.concat(this._deflate[t],this._deflate[_]);v&&(O=O.slice(0,O.length-4)),this._deflate[d]=null,this._deflate[_]=0,this._deflate[t]=[],v&&this.params[`${b}_no_context_takeover`]&&this._deflate.reset(),w(null,O)})}}},957:(y,p,n)=>{const{Writable:c}=n(781),g=n(196),{BINARY_TYPES:m,EMPTY_BUFFER:f,kStatusCode:i,kWebSocket:h}=n(872),{concat:o,toArrayBuffer:_,unmask:d}=n(977),{isValidStatusCode:t,isValidUTF8:s}=n(746);function r(e,u,a,l,v){const w=new e(a?`Invalid WebSocket frame: ${u}`:u);return Error.captureStackTrace(w,r),w.code=v,w[i]=l,w}y.exports=class extends c{constructor(e,u,a,l){super(),this._binaryType=e||m[0],this[h]=void 0,this._extensions=u||{},this._isServer=!!a,this._maxPayload=0|l,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,u,a){if(this._opcode===8&&this._state==0)return a();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(a)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const a=this._buffers[0];return this._buffers[0]=a.slice(e),a.slice(0,e)}const u=Buffer.allocUnsafe(e);do{const a=this._buffers[0],l=u.length-e;e>=a.length?u.set(this._buffers.shift(),l):(u.set(new Uint8Array(a.buffer,a.byteOffset,e),l),this._buffers[0]=a.slice(e)),e-=a.length}while(e>0);return u}startLoop(e){let u;this._loop=!0;do switch(this._state){case 0:u=this.getInfo();break;case 1:u=this.getPayloadLength16();break;case 2:u=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:u=this.getData(e);break;default:return void(this._loop=!1)}while(this._loop);e(u)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(48&e[0])return this._loop=!1,r(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const u=(64&e[0])==64;if(u&&!this._extensions[g.extensionName])return this._loop=!1,r(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(128&e[0])==128,this._opcode=15&e[0],this._payloadLength=127&e[1],this._opcode===0){if(u)return this._loop=!1,r(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,r(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,r(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=u}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,r(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,r(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(u)return this._loop=!1,r(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,r(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&e[1])==128,this._isServer){if(!this._masked)return this._loop=!1,r(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,r(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=1;else{if(this._payloadLength!==127)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),u=e.readUInt32BE(0);return u>Math.pow(2,21)-1?(this._loop=!1,r(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=u*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,r(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let u=f;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);u=this.consume(this._payloadLength),this._masked&&d(u,this._mask)}return this._opcode>7?this.controlMessage(u):this._compressed?(this._state=5,void this.decompress(u,e)):(u.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(u)),this.dataMessage())}decompress(e,u){this._extensions[g.extensionName].decompress(e,this._fin,(a,l)=>{if(a)return u(a);if(l.length){if(this._messageLength+=l.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return u(r(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(l)}const v=this.dataMessage();if(v)return u(v);this.startLoop(u)})}dataMessage(){if(this._fin){const e=this._messageLength,u=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let a;a=this._binaryType==="nodebuffer"?o(u,e):this._binaryType==="arraybuffer"?_(o(u,e)):u,this.emit("message",a)}else{const a=o(u,e);if(!s(a))return this._loop=!1,r(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",a.toString())}}this._state=0}controlMessage(e){if(this._opcode===8)if(this._loop=!1,e.length===0)this.emit("conclude",1005,""),this.end();else{if(e.length===1)return r(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{const u=e.readUInt16BE(0);if(!t(u))return r(RangeError,`invalid status code ${u}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const a=e.slice(2);if(!s(a))return r(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",u,a.toString()),this.end()}}else this._opcode===9?this.emit("ping",e):this.emit("pong",e);this._state=0}}},330:(y,p,n)=>{n(808),n(404);const{randomFillSync:c}=n(113),g=n(196),{EMPTY_BUFFER:m}=n(872),{isValidStatusCode:f}=n(746),{mask:i,toBuffer:h}=n(977),o=Buffer.alloc(4);class _{constructor(t,s){this._extensions=s||{},this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,s){const r=s.mask&&s.readOnly;let e=s.mask?6:2,u=t.length;t.length>=65536?(e+=8,u=127):t.length>125&&(e+=2,u=126);const a=Buffer.allocUnsafe(r?t.length+e:e);return a[0]=s.fin?128|s.opcode:s.opcode,s.rsv1&&(a[0]|=64),a[1]=u,u===126?a.writeUInt16BE(t.length,2):u===127&&(a.writeUInt32BE(0,2),a.writeUInt32BE(t.length,6)),s.mask?(c(o,0,4),a[1]|=128,a[e-4]=o[0],a[e-3]=o[1],a[e-2]=o[2],a[e-1]=o[3],r?(i(t,o,a,e,t.length),[a]):(i(t,o,t,0,t.length),[a,t])):[a,t]}close(t,s,r,e){let u;if(t===void 0)u=m;else{if(typeof t!="number"||!f(t))throw new TypeError("First argument must be a valid error code number");if(s===void 0||s==="")u=Buffer.allocUnsafe(2),u.writeUInt16BE(t,0);else{const a=Buffer.byteLength(s);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");u=Buffer.allocUnsafe(2+a),u.writeUInt16BE(t,0),u.write(s,2)}}this._deflating?this.enqueue([this.doClose,u,r,e]):this.doClose(u,r,e)}doClose(t,s,r){this.sendFrame(_.frame(t,{fin:!0,rsv1:!1,opcode:8,mask:s,readOnly:!1}),r)}ping(t,s,r){const e=h(t);if(e.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,e,s,h.readOnly,r]):this.doPing(e,s,h.readOnly,r)}doPing(t,s,r,e){this.sendFrame(_.frame(t,{fin:!0,rsv1:!1,opcode:9,mask:s,readOnly:r}),e)}pong(t,s,r){const e=h(t);if(e.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,e,s,h.readOnly,r]):this.doPong(e,s,h.readOnly,r)}doPong(t,s,r,e){this.sendFrame(_.frame(t,{fin:!0,rsv1:!1,opcode:10,mask:s,readOnly:r}),e)}send(t,s,r){const e=h(t),u=this._extensions[g.extensionName];let a=s.binary?2:1,l=s.compress;if(this._firstFragment?(this._firstFragment=!1,l&&u&&(l=e.length>=u._threshold),this._compress=l):(l=!1,a=0),s.fin&&(this._firstFragment=!0),u){const v={fin:s.fin,rsv1:l,opcode:a,mask:s.mask,readOnly:h.readOnly};this._deflating?this.enqueue([this.dispatch,e,this._compress,v,r]):this.dispatch(e,this._compress,v,r)}else this.sendFrame(_.frame(e,{fin:s.fin,rsv1:!1,opcode:a,mask:s.mask,readOnly:h.readOnly}),r)}dispatch(t,s,r,e){if(!s)return void this.sendFrame(_.frame(t,r),e);const u=this._extensions[g.extensionName];this._bufferedBytes+=t.length,this._deflating=!0,u.compress(t,r.fin,(a,l)=>{if(this._socket.destroyed){const v=new Error("The socket was closed while data was being compressed");typeof e=="function"&&e(v);for(let w=0;w<this._queue.length;w++){const b=this._queue[w][4];typeof b=="function"&&b(v)}}else this._bufferedBytes-=t.length,this._deflating=!1,r.readOnly=!1,this.sendFrame(_.frame(l,r),e),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const t=this._queue.shift();this._bufferedBytes-=t[1].length,Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[1].length,this._queue.push(t)}sendFrame(t,s){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],s),this._socket.uncork()):this._socket.write(t[0],s)}}y.exports=_},30:(y,p,n)=>{const{Duplex:c}=n(781);function g(i){i.emit("close")}function m(){!this.destroyed&&this._writableState.finished&&this.destroy()}function f(i){this.removeListener("error",f),this.destroy(),this.listenerCount("error")===0&&this.emit("error",i)}y.exports=function(i,h){let o=!0,_=!0;function d(){o&&i._socket.resume()}i.readyState===i.CONNECTING?i.once("open",function(){i._receiver.removeAllListeners("drain"),i._receiver.on("drain",d)}):(i._receiver.removeAllListeners("drain"),i._receiver.on("drain",d));const t=new c({...h,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return i.on("message",function(s){t.push(s)||(o=!1,i._socket.pause())}),i.once("error",function(s){t.destroyed||(_=!1,t.destroy(s))}),i.once("close",function(){t.destroyed||t.push(null)}),t._destroy=function(s,r){if(i.readyState===i.CLOSED)return r(s),void process.nextTick(g,t);let e=!1;i.once("error",function(u){e=!0,r(u)}),i.once("close",function(){e||r(s),process.nextTick(g,t)}),_&&i.terminate()},t._final=function(s){i.readyState!==i.CONNECTING?i._socket!==null&&(i._socket._writableState.finished?(s(),t._readableState.endEmitted&&t.destroy()):(i._socket.once("finish",function(){s()}),i.close())):i.once("open",function(){t._final(s)})},t._read=function(){i.readyState!==i.OPEN||o||(o=!0,i._receiver._writableState.needDrain||i._socket.resume())},t._write=function(s,r,e){i.readyState!==i.CONNECTING?i.send(s,e):i.once("open",function(){t._write(s,r,e)})},t.on("end",m),t.on("error",f),t}},746:(y,p,n)=>{function c(m){return m>=1e3&&m<=1014&&m!==1004&&m!==1005&&m!==1006||m>=3e3&&m<=4999}function g(m){const f=m.length;let i=0;for(;i<f;)if(!(128&m[i]))i++;else if((224&m[i])==192){if(i+1===f||(192&m[i+1])!=128||(254&m[i])==192)return!1;i+=2}else if((240&m[i])==224){if(i+2>=f||(192&m[i+1])!=128||(192&m[i+2])!=128||m[i]===224&&(224&m[i+1])==128||m[i]===237&&(224&m[i+1])==160)return!1;i+=3}else{if((248&m[i])!=240||i+3>=f||(192&m[i+1])!=128||(192&m[i+2])!=128||(192&m[i+3])!=128||m[i]===240&&(240&m[i+1])==128||m[i]===244&&m[i+1]>143||m[i]>244)return!1;i+=4}return!0}try{let m=n(311);typeof m=="object"&&(m=m.Validation.isValidUTF8),y.exports={isValidStatusCode:c,isValidUTF8:f=>f.length<150?g(f):m(f)}}catch{y.exports={isValidStatusCode:c,isValidUTF8:g}}},284:(y,p,n)=>{const c=n(361),g=n(685),{createHash:m}=(n(687),n(808),n(404),n(113)),f=n(196),i=n(762),{format:h,parse:o}=n(503),{GUID:_,kWebSocket:d}=n(872),t=/^[+/0-9A-Za-z]{22}==$/;function s(a){a._state=2,a.emit("close")}function r(){this.destroy()}function e(a,l,v,w){a.writable&&(v=v||g.STATUS_CODES[l],w={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(v),...w},a.write(`HTTP/1.1 ${l} ${g.STATUS_CODES[l]}\r
`+Object.keys(w).map(b=>`${b}: ${w[b]}`).join(`\r
`)+`\r
\r
`+v)),a.removeListener("error",r),a.destroy()}function u(a){return a.trim()}y.exports=class extends c{constructor(a,l){if(super(),(a={maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...a}).port==null&&!a.server&&!a.noServer||a.port!=null&&(a.server||a.noServer)||a.server&&a.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(a.port!=null?(this._server=g.createServer((v,w)=>{const b=g.STATUS_CODES[426];w.writeHead(426,{"Content-Length":b.length,"Content-Type":"text/plain"}),w.end(b)}),this._server.listen(a.port,a.host,a.backlog,l)):a.server&&(this._server=a.server),this._server){const v=this.emit.bind(this,"connection");this._removeListeners=function(w,b){for(const O of Object.keys(b))w.on(O,b[O]);return function(){for(const O of Object.keys(b))w.removeListener(O,b[O])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(w,b,O)=>{this.handleUpgrade(w,b,O,v)}})}a.perMessageDeflate===!0&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set),this.options=a,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(a&&this.once("close",a),this._state===2)return void process.nextTick(s,this);if(this._state===1)return;if(this._state=1,this.clients)for(const v of this.clients)v.terminate();const l=this._server;l&&(this._removeListeners(),this._removeListeners=this._server=null,this.options.port!=null)?l.close(s.bind(void 0,this)):process.nextTick(s,this)}shouldHandle(a){if(this.options.path){const l=a.url.indexOf("?");if((l!==-1?a.url.slice(0,l):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,l,v,w){l.on("error",r);const b=a.headers["sec-websocket-key"]!==void 0&&a.headers["sec-websocket-key"].trim(),O=+a.headers["sec-websocket-version"],q={};if(a.method!=="GET"||a.headers.upgrade.toLowerCase()!=="websocket"||!b||!t.test(b)||O!==8&&O!==13||!this.shouldHandle(a))return e(l,400);if(this.options.perMessageDeflate){const R=new f(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const B=o(a.headers["sec-websocket-extensions"]);B[f.extensionName]&&(R.accept(B[f.extensionName]),q[f.extensionName]=R)}catch{return e(l,400)}}if(this.options.verifyClient){const R={origin:a.headers[O===8?"sec-websocket-origin":"origin"],secure:!(!a.socket.authorized&&!a.socket.encrypted),req:a};if(this.options.verifyClient.length===2)return void this.options.verifyClient(R,(B,P,C,x)=>{if(!B)return e(l,P||401,C,x);this.completeUpgrade(b,q,a,l,v,w)});if(!this.options.verifyClient(R))return e(l,401)}this.completeUpgrade(b,q,a,l,v,w)}completeUpgrade(a,l,v,w,b,O){if(!w.readable||!w.writable)return w.destroy();if(w[d])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return e(w,503);const q=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${m("sha1").update(a+_).digest("base64")}`],R=new i(null);let B=v.headers["sec-websocket-protocol"];if(B&&(B=B.split(",").map(u),B=this.options.handleProtocols?this.options.handleProtocols(B,v):B[0],B&&(q.push(`Sec-WebSocket-Protocol: ${B}`),R._protocol=B)),l[f.extensionName]){const P=l[f.extensionName].params,C=h({[f.extensionName]:[P]});q.push(`Sec-WebSocket-Extensions: ${C}`),R._extensions=l}this.emit("headers",q,v),w.write(q.concat(`\r
`).join(`\r
`)),w.removeListener("error",r),R.setSocket(w,b,this.options.maxPayload),this.clients&&(this.clients.add(R),R.on("close",()=>this.clients.delete(R))),O(R,v)}}},762:(y,p,n)=>{const c=n(361),g=n(687),m=n(685),f=n(808),i=n(404),{randomBytes:h,createHash:o}=n(113),{Readable:_}=n(781),{URL:d}=n(310),t=n(196),s=n(957),r=n(330),{BINARY_TYPES:e,EMPTY_BUFFER:u,GUID:a,kStatusCode:l,kWebSocket:v,NOOP:w}=n(872),{addEventListener:b,removeEventListener:O}=n(62),{format:q,parse:R}=n(503),{toBuffer:B}=n(977),P=["CONNECTING","OPEN","CLOSING","CLOSED"],C=[8,13];class x extends c{constructor(E,L,N){super(),this._binaryType=e[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._extensions={},this._protocol="",this._readyState=x.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,E!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(L)?L=L.join(", "):typeof L=="object"&&L!==null&&(N=L,L=void 0),D(this,E,L,N)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(E){e.includes(E)&&(this._binaryType=E,this._receiver&&(this._receiver._binaryType=E))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get onclose(){}set onclose(E){}get onerror(){}set onerror(E){}get onopen(){}set onopen(E){}get onmessage(){}set onmessage(E){}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(E,L,N){const $=new s(this.binaryType,this._extensions,this._isServer,N);this._sender=new r(E,this._extensions),this._receiver=$,this._socket=E,$[v]=this,E[v]=this,$.on("conclude",te),$.on("drain",ue),$.on("error",he),$.on("message",ut),$.on("ping",ht),$.on("pong",dt),E.setTimeout(0),E.setNoDelay(),L.length>0&&E.unshift(L),E.on("close",Ee),E.on("data",de),E.on("end",xe),E.on("error",ke),this._readyState=x.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=x.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[t.extensionName]&&this._extensions[t.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=x.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(E,L){if(this.readyState!==x.CLOSED){if(this.readyState===x.CONNECTING)return z(this,this._req,"WebSocket was closed before the connection was established");this.readyState!==x.CLOSING?(this._readyState=x.CLOSING,this._sender.close(E,L,!this._isServer,N=>{N||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end()}}ping(E,L,N){if(this.readyState===x.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");typeof E=="function"?(N=E,E=L=void 0):typeof L=="function"&&(N=L,L=void 0),typeof E=="number"&&(E=E.toString()),this.readyState===x.OPEN?(L===void 0&&(L=!this._isServer),this._sender.ping(E||u,L,N)):Z(this,E,N)}pong(E,L,N){if(this.readyState===x.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");typeof E=="function"?(N=E,E=L=void 0):typeof L=="function"&&(N=L,L=void 0),typeof E=="number"&&(E=E.toString()),this.readyState===x.OPEN?(L===void 0&&(L=!this._isServer),this._sender.pong(E||u,L,N)):Z(this,E,N)}send(E,L,N){if(this.readyState===x.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof L=="function"&&(N=L,L={}),typeof E=="number"&&(E=E.toString()),this.readyState!==x.OPEN)return void Z(this,E,N);const $={binary:typeof E!="string",mask:!this._isServer,compress:!0,fin:!0,...L};this._extensions[t.extensionName]||($.compress=!1),this._sender.send(E||u,$,N)}terminate(){if(this.readyState!==x.CLOSED){if(this.readyState===x.CONNECTING)return z(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=x.CLOSING,this._socket.destroy())}}}function D(S,E,L,N){const $={protocolVersion:C[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...N,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!C.includes($.protocolVersion))throw new RangeError(`Unsupported protocol version: ${$.protocolVersion} (supported versions: ${C.join(", ")})`);let I;E instanceof d?(I=E,S._url=E.href):(I=new d(E),S._url=E);const Oe=I.protocol==="ws+unix:";if(!(I.host||Oe&&I.pathname))throw new Error(`Invalid URL: ${S.url}`);const pe=I.protocol==="wss:"||I.protocol==="https:",Le=pe?443:80,Te=h(16).toString("base64"),ft=pe?g.get:m.get;let ie;if($.createConnection=pe?le:M,$.defaultPort=$.defaultPort||Le,$.port=I.port||Le,$.host=I.hostname.startsWith("[")?I.hostname.slice(1,-1):I.hostname,$.headers={"Sec-WebSocket-Version":$.protocolVersion,"Sec-WebSocket-Key":Te,Connection:"Upgrade",Upgrade:"websocket",...$.headers},$.path=I.pathname+I.search,$.timeout=$.handshakeTimeout,$.perMessageDeflate&&(ie=new t($.perMessageDeflate!==!0?$.perMessageDeflate:{},!1,$.maxPayload),$.headers["Sec-WebSocket-Extensions"]=q({[t.extensionName]:ie.offer()})),L&&($.headers["Sec-WebSocket-Protocol"]=L),$.origin&&($.protocolVersion<13?$.headers["Sec-WebSocket-Origin"]=$.origin:$.headers.Origin=$.origin),(I.username||I.password)&&($.auth=`${I.username}:${I.password}`),Oe){const F=$.path.split(":");$.socketPath=F[0],$.path=F[1]}let H=S._req=ft($);$.timeout&&H.on("timeout",()=>{z(S,H,"Opening handshake has timed out")}),H.on("error",F=>{H===null||H.aborted||(H=S._req=null,S._readyState=x.CLOSING,S.emit("error",F),S.emitClose())}),H.on("response",F=>{const Y=F.headers.location,fe=F.statusCode;if(Y&&$.followRedirects&&fe>=300&&fe<400){if(++S._redirects>$.maxRedirects)return void z(S,H,"Maximum redirects exceeded");H.abort();const me=new d(Y,E);D(S,me,L,N)}else S.emit("unexpected-response",H,F)||z(S,H,`Unexpected server response: ${F.statusCode}`)}),H.on("upgrade",(F,Y,fe)=>{if(S.emit("upgrade",F),S.readyState!==x.CONNECTING)return;H=S._req=null;const me=o("sha1").update(Te+a).digest("base64");if(F.headers["sec-websocket-accept"]!==me)return void z(S,Y,"Invalid Sec-WebSocket-Accept header");const Q=F.headers["sec-websocket-protocol"],_t=(L||"").split(/, */);let se;if(!L&&Q?se="Server sent a subprotocol but none was requested":L&&!Q?se="Server sent no subprotocol":Q&&!_t.includes(Q)&&(se="Server sent an invalid subprotocol"),se)return void z(S,Y,se);Q&&(S._protocol=Q);const Pe=F.headers["sec-websocket-extensions"];if(Pe!==void 0){if(!ie)return void z(S,Y,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");let ve;try{ve=R(Pe)}catch{return void z(S,Y,"Invalid Sec-WebSocket-Extensions header")}const ye=Object.keys(ve);if(ye.length){if(ye.length!==1||ye[0]!==t.extensionName)return void z(S,Y,"Server indicated an extension that was not requested");try{ie.accept(ve[t.extensionName])}catch{return void z(S,Y,"Invalid Sec-WebSocket-Extensions header")}S._extensions[t.extensionName]=ie}}S.setSocket(Y,fe,$.maxPayload)})}function M(S){return S.path=S.socketPath,f.connect(S)}function le(S){return S.path=void 0,S.servername||S.servername===""||(S.servername=f.isIP(S.host)?"":S.host),i.connect(S)}function z(S,E,L){S._readyState=x.CLOSING;const N=new Error(L);Error.captureStackTrace(N,z),E.setHeader?(E.abort(),E.socket&&!E.socket.destroyed&&E.socket.destroy(),E.once("abort",S.emitClose.bind(S)),S.emit("error",N)):(E.destroy(N),E.once("error",S.emit.bind(S,"error")),E.once("close",S.emitClose.bind(S)))}function Z(S,E,L){if(E){const N=B(E).length;S._socket?S._sender._bufferedBytes+=N:S._bufferedAmount+=N}L&&L(new Error(`WebSocket is not open: readyState ${S.readyState} (${P[S.readyState]})`))}function te(S,E){const L=this[v];L._closeFrameReceived=!0,L._closeMessage=E,L._closeCode=S,L._socket[v]!==void 0&&(L._socket.removeListener("data",de),process.nextTick(Se,L._socket),S===1005?L.close():L.close(S,E))}function ue(){this[v]._socket.resume()}function he(S){const E=this[v];E._socket[v]!==void 0&&(E._socket.removeListener("data",de),process.nextTick(Se,E._socket),E.close(S[l])),E.emit("error",S)}function re(){this[v].emitClose()}function ut(S){this[v].emit("message",S)}function ht(S){const E=this[v];E.pong(S,!E._isServer,w),E.emit("ping",S)}function dt(S){this[v].emit("pong",S)}function Se(S){S.resume()}function Ee(){const S=this[v];let E;this.removeListener("close",Ee),this.removeListener("data",de),this.removeListener("end",xe),S._readyState=x.CLOSING,this._readableState.endEmitted||S._closeFrameReceived||S._receiver._writableState.errorEmitted||(E=S._socket.read())===null||S._receiver.write(E),S._receiver.end(),this[v]=void 0,clearTimeout(S._closeTimer),S._receiver._writableState.finished||S._receiver._writableState.errorEmitted?S.emitClose():(S._receiver.on("error",re),S._receiver.on("finish",re))}function de(S){this[v]._receiver.write(S)||this.pause()}function xe(){const S=this[v];S._readyState=x.CLOSING,S._receiver.end(),this.end()}function ke(){const S=this[v];this.removeListener("error",ke),this.on("error",w),S&&(S._readyState=x.CLOSING,this.destroy())}Object.defineProperty(x,"CONNECTING",{enumerable:!0,value:P.indexOf("CONNECTING")}),Object.defineProperty(x.prototype,"CONNECTING",{enumerable:!0,value:P.indexOf("CONNECTING")}),Object.defineProperty(x,"OPEN",{enumerable:!0,value:P.indexOf("OPEN")}),Object.defineProperty(x.prototype,"OPEN",{enumerable:!0,value:P.indexOf("OPEN")}),Object.defineProperty(x,"CLOSING",{enumerable:!0,value:P.indexOf("CLOSING")}),Object.defineProperty(x.prototype,"CLOSING",{enumerable:!0,value:P.indexOf("CLOSING")}),Object.defineProperty(x,"CLOSED",{enumerable:!0,value:P.indexOf("CLOSED")}),Object.defineProperty(x.prototype,"CLOSED",{enumerable:!0,value:P.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","protocol","readyState","url"].forEach(S=>{Object.defineProperty(x.prototype,S,{enumerable:!0})}),["open","error","close","message"].forEach(S=>{Object.defineProperty(x.prototype,`on${S}`,{enumerable:!0,get(){const E=this.listeners(S);for(let L=0;L<E.length;L++)if(E[L]._listener)return E[L]._listener},set(E){const L=this.listeners(S);for(let N=0;N<L.length;N++)L[N]._listener&&this.removeListener(S,L[N]);this.addEventListener(S,E)}})}),x.prototype.addEventListener=b,x.prototype.removeEventListener=O,y.exports=x},113:y=>{y.exports=qe},361:y=>{y.exports=Be},147:y=>{y.exports=je},685:y=>{y.exports=Ie},687:y=>{y.exports=Ae},808:y=>{y.exports=Ge},37:y=>{y.exports=Fe},17:y=>{y.exports=He},477:y=>{y.exports=Ye},781:y=>{y.exports=Xe},404:y=>{y.exports=Qe},310:y=>{y.exports=tt},796:y=>{y.exports=it}},X={};function j(y){var p=X[y];if(p!==void 0)return p.exports;var n=X[y]={exports:{}};return G[y].call(n.exports,n,n.exports,j),n.exports}j.n=y=>{var p=y&&y.__esModule?()=>y.default:()=>y;return j.d(p,{a:p}),p},j.d=(y,p)=>{for(var n in p)j.o(p,n)&&!j.o(y,n)&&Object.defineProperty(y,n,{enumerable:!0,get:p[n]})},j.o=(y,p)=>Object.prototype.hasOwnProperty.call(y,p),j.r=y=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(y,"__esModule",{value:!0})};var we={};return(()=>{var y=we;Object.defineProperty(y,"__esModule",{value:!0}),y.Deepgram=void 0;var p=j(986),n=j(292),c=j(319),g=j(487),m=j(321),f=j(949),i=j(359),h=j(343),o=j(647),_=j(298),d=j(98);y.Deepgram=function(t,s,r){this._apiKey=t,this._apiUrl=s||p.DefaultOptions.apiUrl,this._requireSSL=r||p.DefaultOptions.requireSSL,(0,_.validateOptions)(this._apiKey,this._apiUrl),this.keys=new n.Keys(this._apiKey,this._apiUrl,this._requireSSL,d._request),this.projects=new c.Projects(this._apiKey,this._apiUrl,this._requireSSL,d._request),this.transcription=new g.Transcriber(this._apiKey,this._apiUrl,this._requireSSL),this.usage=new m.Usage(this._apiKey,this._apiUrl,this._requireSSL,d._request),this.members=new f.Members(this._apiKey,this._apiUrl,this._requireSSL,d._request),this.invitation=new i.Invitation(this._apiKey,this._apiUrl,this._requireSSL,d._request),this.billing=new h.Billing(this._apiKey,this._apiUrl,this._requireSSL,d._request),this.scopes=new o.Scopes(this._apiKey,this._apiUrl,this._requireSSL,d._request)}})(),we})())})(ge);var st=ge.exports;window.document.getElementById("captions");let ee=null,A=null,W=null,K="",_e,ne,oe=!1,nt=!1;async function ot(){return ee=await navigator.mediaDevices.getUserMedia({audio:!0}),new MediaRecorder(ee)}async function at(){K="";try{window.shutUp()}catch(T){console.warn("error interrupting avatar",T)}if(A)try{A.stop(),A.removeAllListeners(),A=null}catch(T){console.warn("error closing microphone",T)}A=await ot(),await A.start(50),A.onstart=()=>{console.log("client: microphone opened"),document.body.classList.add("recording")},A.onstop=()=>{console.log("client: microphone closed"),document.body.classList.remove("recording");try{A.removeAllListeners()}catch{}A=null},A.ondataavailable=T=>{const k=T.data;console.log("client: sent data to websocket"),W.send(k)}}async function ct(){if(!A){console.log("microphone undefined or not open, not running close code");return}try{A.stop()}catch{}setTimeout(()=>{try{A.removeAllListeners()}catch{}if(K&&K!="")try{let T=K;K==""&&(T=userInput.value),window.handleSpeak(T)}catch(T){console.warn("error calling handleSpeak",T)}K="",console.log("closing and cleaning up microphone");try{ee&&ee.getTracks().forEach(T=>{T.stop()})}catch{}ee=null,console.log("client: microphone closed"),document.body.classList.remove("recording"),A=null,setTimeout(()=>{ce()},30)},50)}function ae(T){console.log("mousedown event"),T.preventDefault(),at()}function J(T){console.log("mouseup event"),T.preventDefault(),setTimeout(ct,250)}async function lt(T){const k=document.getElementById("record");if(!k){console.warn("no listen button found");return}if(k)try{k.removeEventListener("mousedown",ae),k.removeEventListener("touchstart",ae),k.removeEventListener("mouseup",J),k.removeEventListener("mouseleave",J),k.removeEventListener("touchend",J),k.removeEventListener("touchcancel",J)}catch{console.log("no button listeners to remove")}if(console.log("client: waiting to open microphone"),k.addEventListener("mousedown",ae),k.addEventListener("touchstart",ae),k.addEventListener("mouseup",J),k.addEventListener("mouseleave",J),k.addEventListener("touchend",J),k.addEventListener("touchcancel",J),_e)try{clearInterval(_e)}catch{}_e=setInterval(()=>{try{T&&(T.keepAlive(),console.log("sent keepalive"))}catch(U){console.log("error keeping connection alive",U)}},1e4)}async function ce(){if(oe){console.log("already initializing TTS, returning");return}oe=!0;try{const T="a2dae355bff63649e396812508e25624420fc377";if(W){try{W.removeAllListeners()}catch(k){console.warn("error removing socket listeners",k)}W=void 0}ne&&(ne=void 0),ne=st.createClient(T),W=ne.listen.live({model:"nova-2",smart_format:!0,interim_results:!0,punctuate:!0,numerals:!0,endpointing:50}),W.on("open",async()=>{console.log("%c socket open event","background: green; color: yellow"),console.log("client: connected to websocket")}),W.on("Results",async k=>{console.log("%c socket results event"+JSON.stringify(k),"background: blue; color: yellow"),console.log(k);const U=k.channel.alternatives[0].transcript;if(U!==""){try{await window.shutUp()}catch(G){console.warn("error shutting up avatar",G)}userInput.value=U,k.is_final&&(K+=U+" ",userInput.value=K,nt||(handleSpeak(K!=""?K:userInput.value),K="",await new Promise(G=>setTimeout(G,100)),userInput.value=""))}}),W.on("error",k=>{console.error(k),W.removeAllListeners(),setTimeout(()=>{console.log("%c socket error, reset","background: green; color: yellow"),ce()},30)}),W.on("warning",k=>console.warn(k)),W.on("Metadata",k=>console.log(k)),W.on("close",k=>{console.log("%c socket close, reset","background: green; color: yellow"),console.log(k),W.removeAllListeners(),setTimeout(()=>{oe||ce()},30)}),await lt(W)}catch(T){console.error("error in inittts",T)}finally{oe=!1}}window.addEventListener("load",async()=>{console.log("Initializing TTS"),await ce()});function be(){document.querySelectorAll("chat-form").forEach(k=>{const U=k.shadowRoot.querySelector("#chat-right-insert");if(U){const G=document.createElement("chat-tts");U.appendChild(G),U.style.display="flex",U.style.alignItems="center",U.style.marginRight="10px"}})}window.addEventListener("load",()=>{setTimeout(be,100)}),new MutationObserver(T=>{T.forEach(k=>{k.addedNodes.forEach(U=>{U.nodeName==="CHAT-FORM"&&setTimeout(()=>be(),100)})})}).observe(document.body,{childList:!0,subtree:!0})})();
